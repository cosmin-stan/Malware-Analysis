
We used FLOSS to extract the PE strings and dump them into a txt file:


`floss.exe -n 8 Ransomware.wannacry.exe.malz > wannacry_strings.txt`

![image](https://user-images.githubusercontent.com/36852270/210041785-cdf872e8-bfa8-4a50-b24a-b17412ca62a2.png)

[Floss file](https://github.com/cosminstan95/Malware-Analysis/blob/main/Malware/Ransomware/Wannacry/wannacry_strings.txt)


Suspicious strings:

![image](https://user-images.githubusercontent.com/36852270/210041826-6afd842f-277b-4324-a782-c2ec9f54f1cf.png)

In a loop, generate a random global IP address with the use of CryptGenRandom() modulo 255, and skip all addresses starting with 127, 224 (or higher) or LAN addresses calculated;

CryptAcquireContext() to initialize the crypto API so it can use a cryptographically-secure pseudo-random number generator!

![image](https://user-images.githubusercontent.com/36852270/210041828-fbf7eec1-51d8-44f7-8e66-d6cb7c4c92a9.png)

![image](https://user-images.githubusercontent.com/36852270/210041831-1f4b60fe-9b11-43dd-9d94-e6e17584e336.png)

![image](https://user-images.githubusercontent.com/36852270/210041835-9f59d17c-a566-4c1a-b718-0f2a7a20c725.png)

![image](https://user-images.githubusercontent.com/36852270/210041863-05e5da2c-5c91-4ffc-8e12-7e66553b5e4b.png)

Ransomware Popup message:

![image](https://user-images.githubusercontent.com/36852270/210041899-be72caec-c01b-4f63-b4e4-0582429399e0.png)

Suspicious URL

![image](https://user-images.githubusercontent.com/36852270/210041921-908c0d3f-ab32-4244-b3bb-48e4f28d1149.png)

![image](https://user-images.githubusercontent.com/36852270/210041972-3d094968-ea52-462b-99a8-2e85ea210af2.png)


Also:

![image](https://user-images.githubusercontent.com/36852270/210041987-683efab8-56e3-4f8a-a6c1-33ca0fb297d0.png)

Advapi32. dll is a part of the advanced API services library. It provides access to advanced functionality that comes in addition to the kernel. It is responsible for things like the Windows registry, restarting and shutting down the system, starting/stopping and creating Windows services, and managing user accounts!

![image](https://user-images.githubusercontent.com/36852270/210042002-47601416-b237-4860-b17f-06e749ded756.png)

icacls is a Windows command-line utility that IT admins can use to change access control lists on files and folders.

We also used <b>PEStudio</b> to highlight some IOC:

Strings:

![image](https://user-images.githubusercontent.com/36852270/210042930-9c9746e7-78f1-475a-aa35-0e0c88a700e5.png)

Libraries:

 ![image](https://user-images.githubusercontent.com/36852270/210042968-326a5c40-eba4-4636-a7c8-f28a434860fa.png)








